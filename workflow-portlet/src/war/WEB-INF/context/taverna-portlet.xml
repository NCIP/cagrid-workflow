<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.0.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.0.xsd
        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.0.xsd">

    <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="cache" value="true"/>
        <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/>
        <property name="prefix" value="/jsp/"/>
        <property name="suffix" value=".jsp"/>
    </bean>

    <bean id="portletModeHandlerMapping" class="org.springframework.web.portlet.handler.PortletModeHandlerMapping">
        <property name="portletModeMap">
            <map>
                <entry key="view"><ref local="tavernaWorkflowController"/></entry>
            </map>
        </property>
    </bean>
<!--
	<bean id="portletModeParameterHandlerMapping" class="org.springframework.web.portlet.handler.PortletModeParameterHandlerMapping">
        <property name="portletModeParameterMap">
            <map>
                <entry key="view">
	                <map>
	                    <entry key="selectWorkflow">
	                        <ref local="tavernaWorkflowController-2"/>
	                    </entry>
	                    <entry key="submitWorkflow">
	                        <ref local="tavernaWorkflowController-3"/>
	                    </entry>
	                </map>
                </entry>
            </map>
        </property>
    </bean>
	
	<bean id="tavernaWorkflowController-2" class="gov.nih.nci.cagrid.portal.portlet.sample.TavernaPortletController2">
        <property name="commandClass" value="gov.nih.nci.cagrid.portal.portlet.sample.WorkflowBean"/>
        <property name="commandName" value="cmd"/>
        <property name="formView" value="test"/>
        <property name="successView" value="result"/>
        <property name="twsHelper">
            <bean class="gov.nih.nci.cagrid.portal.portlet.sample.TavernaWorkflowServiceHelper">
                <property name="tavernaWorkflowServiceUrl" value="http://localhost:8081/wsrf/services/cagrid/TavernaWorkflowService"/>
                <property name="sessionEprsRef" ref="sessionEprs"/>
            </bean>
        </property>
        <property name="workflowList">
            <map>
                <entry key="workflow-1"><ref local="workflow-1"/></entry>
                <entry key="workflow-2"><ref local="workflow-2"/></entry>
            </map>
        </property>
    </bean>
    
    <bean id="tavernaWorkflowController-3" class="gov.nih.nci.cagrid.portal.portlet.sample.TavernaPortletController">
        <property name="commandClass" value="gov.nih.nci.cagrid.portal.portlet.sample.WorkflowBean"/>
        <property name="commandName" value="cmd"/>
        <property name="formView" value="view"/>
        <property name="successView" value="result"/>
        <property name="twsHelper">
            <bean class="gov.nih.nci.cagrid.portal.portlet.sample.TavernaWorkflowServiceHelper">
                <property name="tavernaWorkflowServiceUrl" value="http://localhost:8081/wsrf/services/cagrid/TavernaWorkflowService"/>
                <property name="sessionEprsRef" ref="sessionEprs"/>
            </bean>
        </property>
        <property name="workflowList">
            <map>
                <entry key="workflow-1"><ref local="workflow-1"/></entry>
                <entry key="workflow-2"><ref local="workflow-2"/></entry>
            </map>
        </property>
    </bean>
 -->   
    
    
    <bean id="tavernaWorkflowController" class="gov.nih.nci.cagrid.portal.portlet.sample.TavernaPortletController">
        <property name="commandClass" value="gov.nih.nci.cagrid.portal.portlet.sample.WorkflowBean"/>
        <property name="commandName" value="cmd"/>
        <property name="formView" value="view"/>
        <property name="successView" value="result"/>
        <property name="twsHelper">
            <bean class="gov.nih.nci.cagrid.portal.portlet.sample.TavernaWorkflowServiceHelper">
                <property name="tavernaWorkflowServiceUrl" value="http://communicado.ci.uchicago.edu:51000/wsrf/services/cagrid/TavernaWorkflowService"/>
                <property name="sessionEprsRef" ref="sessionEprs"/>
            </bean>
        </property>
        <property name="workflowList">
            <map>
                <entry key="workflow-3"><ref local="workflow-3"/></entry>
                <entry key="workflow-1"><ref local="workflow-1"/></entry>
                <entry key="workflow-2"><ref local="workflow-2"/></entry>
            </map>
        </property>
    </bean>
    
    <bean id="sessionEprs" class="gov.nih.nci.cagrid.portal.portlet.sample.SessionEprs" scope="session">
		        <aop:scoped-proxy/>
    </bean>
    
    <bean id="workflow-1" class="gov.nih.nci.cagrid.portal.portlet.sample.WorkflowDescription">
        <property name="workflowId" value="workflow-1"/>
        <property name="name" value="Concatenate two Strings (for testing)."/>
        <property name="inputPorts" value="2"/>
        <property name="description" value="It is a simple workflow that takes two strings as input and returns a concatenated string as output."/>
        <property name="author" value="Dinanath Sulakhe"/>
        <property name="filePath" value="classpath:fishsoup.t2flow"/>
        <property name="imageFile" value="fishsoup.png"/>
        <property name="sampleInputs" value="Any two Strings."/>
    </bean>
    <bean id="workflow-2" class="gov.nih.nci.cagrid.portal.portlet.sample.WorkflowDescription">
        <property name="workflowId" value="workflow-2"/>
        <property name="name" value="caDSR metadata query in caGrid"/>
        <property name="inputPorts" value="1"/>
        <property name="description" value="This workflow uses caDSR (Cancer Data Standards Repository) service, which defines a comprehensive set of standardized metadata descriptors for cancer research terminology used in information collection and analysis. This Sample workflow is to find all the concepts related to a given context, for example caCore. The workflow uses context information to invoke findProjects in caDSR and get the project(s) information."/>
        <property name="author" value="Wei Tan"/>
        <property name="filePath" value="classpath:cadsr.t2flow"/>
        <property name="imageFile" value="cadsr.png"/>
        <property name="sampleInputs" value="caCore"/>
   </bean>
    <bean id="workflow-3" class="gov.nih.nci.cagrid.portal.portlet.sample.WorkflowDescription">
        <property name="workflowId" value="workflow-3"/>
        <property name="name" value="Lymphoma type prediction based on microarray data"/>
        <property name="inputPorts" value="1"/>
        <property name="description" value=" Scientific value Using gene-expression patterns associated with DLBCL and FL to predict the lymphoma type of an unknown sample. Using SVM (Support Vector Machine) to classify data, and predicting the tumor types of unknown examples. Steps Querying training data from experiments stored in caArray. Preprocessing, or normalize the microarray data. Adding training and testing data into SVM service to get classification result. The input to this workflow is an Experiment ID. Experiment ID identifies the experiment that caArray uses for data collection. For example, Experiment 95 contains microArray data regarding 77 tumor samples."/>
        <property name="author" value="Wei Tan"/>
        <property name="filePath" value="classpath:caArray_SVM-090710.t2flow"/>
        <property name="imageFile" value="caArray_SVM-090710.png"/>
        <property name="sampleInputs" value="95"/>
        <property name="viewResolver" value="lymphoma"/>
   </bean>

</beans>
